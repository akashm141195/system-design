<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive System Design Tutorial</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .progress-bar {
            background: rgba(255,255,255,0.2);
            height: 8px;
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #4CAF50, #45a049);
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
        }

        .lesson {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            animation: slideIn 0.5s ease-out;
        }

        .lesson.active {
            display: block;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .lesson h2 {
            color: #667eea;
            font-size: 2rem;
            margin-bottom: 20px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .interactive-demo {
            background: #f8f9fa;
            border: 2px dashed #667eea;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .system-component {
            display: inline-block;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 25px;
            margin: 10px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .system-component:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .system-component.active {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            transform: scale(1.05);
        }

        .connection-line {
            height: 3px;
            background: #667eea;
            margin: 10px 50px;
            border-radius: 2px;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .connection-line.visible {
            opacity: 1;
        }

        .info-box {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 5px solid #2196F3;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .challenge {
            background: linear-gradient(135deg, #fff3e0, #ffe0b2);
            border: 2px solid #ff9800;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .challenge h3 {
            color: #e65100;
            margin-bottom: 10px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            margin: 10px 5px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .quiz {
            background: linear-gradient(135deg, #f3e5f5, #e1bee7);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .quiz-option {
            background: white;
            border: 2px solid #9c27b0;
            padding: 10px 20px;
            margin: 10px 0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quiz-option:hover {
            background: #f3e5f5;
        }

        .quiz-option.correct {
            background: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }

        .quiz-option.incorrect {
            background: #f44336;
            color: white;
            border-color: #f44336;
        }

        .navigation {
            text-align: center;
            margin-top: 30px;
        }

        .scenario-builder {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .draggable {
            background: linear-gradient(135deg, #ff9800, #f57c00);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            cursor: grab;
            transition: transform 0.3s ease;
        }

        .draggable:hover {
            transform: scale(1.05);
        }

        .drop-zone {
            min-height: 100px;
            border: 3px dashed #ccc;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .drop-zone.drag-over {
            border-color: #4CAF50;
            background: #e8f5e8;
        }

        .metric-display {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .metric {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            min-width: 150px;
            margin: 10px;
        }

        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
        }

        .feedback {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: bold;
        }

        .feedback.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .feedback.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .lesson {
                padding: 20px;
            }
            
            .system-component {
                display: block;
                margin: 10px 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèóÔ∏è Interactive System Design Tutorial</h1>
            <p>Learn to build scalable systems step by step</p>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>

        <!-- Lesson 1: What is System Design? -->
        <div class="lesson active" data-lesson="1">
            <h2>üéØ What is System Design?</h2>
            <p>System design is like being an architect for software! Just as architects plan buildings, system designers plan how different parts of a software system work together.</p>
            
            <div class="info-box">
                <strong>Think of it like planning a city:</strong><br>
                ‚Ä¢ Roads = Data flow<br>
                ‚Ä¢ Buildings = Services/Components<br>
                ‚Ä¢ Utilities = Infrastructure<br>
                ‚Ä¢ Traffic lights = Load balancers
            </div>

            <div class="interactive-demo">
                <h3>üèôÔ∏è Interactive Demo: Build Your First System</h3>
                <p>Click on components to see how they connect:</p>
                
                <div id="basicSystem">
                    <div class="system-component" onclick="activateComponent(this, 'user')">üë§ User</div>
                    <div class="connection-line" id="line1"></div>
                    <div class="system-component" onclick="activateComponent(this, 'server')">üñ•Ô∏è Web Server</div>
                    <div class="connection-line" id="line2"></div>
                    <div class="system-component" onclick="activateComponent(this, 'database')">üóÑÔ∏è Database</div>
                </div>
                
                <div id="systemExplanation" style="margin-top: 20px; font-style: italic;"></div>
            </div>

            <div class="quiz">
                <h3>üß† Quick Check:</h3>
                <p>What's the main goal of system design?</p>
                <div class="quiz-option" onclick="selectAnswer(this, false)">To write beautiful code</div>
                <div class="quiz-option" onclick="selectAnswer(this, true)">To plan how system components work together</div>
                <div class="quiz-option" onclick="selectAnswer(this, false)">To create user interfaces</div>
            </div>
        </div>

        <!-- Lesson 2: Scalability -->
        <div class="lesson" data-lesson="2">
            <h2>üìà Understanding Scalability</h2>
            <p>Scalability is your system's ability to handle growth. Imagine your favorite restaurant suddenly becoming world-famous overnight!</p>

            <div class="interactive-demo">
                <h3>üçï Restaurant Analogy</h3>
                <p>Current customers: <span id="customerCount">10</span></p>
                <button class="btn" onclick="addCustomers()">üìà Add 100 Customers</button>
                <button class="btn" onclick="scaleSystem()">üîß Scale System</button>
                <button class="btn" onclick="resetRestaurant()">üîÑ Reset</button>
                
                <div class="metric-display">
                    <div class="metric">
                        <div class="metric-value" id="waitTime">5 min</div>
                        <div>Wait Time</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="satisfaction">üòä</div>
                        <div>Customer Satisfaction</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="servers">2</div>
                        <div>Servers</div>
                    </div>
                </div>
                
                <div id="scalingFeedback"></div>
            </div>

            <div class="challenge">
                <h3>üéØ Challenge: Scale a Social Media App</h3>
                <p>Your app started with 1,000 users and now has 1 million! What would you do?</p>
                <div class="scenario-builder" id="scalingScenario">
                    <div class="drop-zone" data-category="frontend">
                        <p>Frontend Solutions</p>
                    </div>
                    <div class="drop-zone" data-category="backend">
                        <p>Backend Solutions</p>
                    </div>
                    <div class="drop-zone" data-category="database">
                        <p>Database Solutions</p>
                    </div>
                </div>
                
                <div style="margin-top: 20px;">
                    <div class="draggable" draggable="true" data-solution="frontend">CDN (Content Delivery Network)</div>
                    <div class="draggable" draggable="true" data-solution="backend">Load Balancer</div>
                    <div class="draggable" draggable="true" data-solution="database">Database Sharding</div>
                    <div class="draggable" draggable="true" data-solution="backend">Microservices</div>
                    <div class="draggable" draggable="true" data-solution="database">Read Replicas</div>
                    <div class="draggable" draggable="true" data-solution="frontend">Caching</div>
                </div>
            </div>
        </div>

        <!-- Lesson 3: System Components -->
        <div class="lesson" data-lesson="3">
            <h2>üß© Essential System Components</h2>
            <p>Every system is built from key components. Let's explore the building blocks!</p>

            <div class="interactive-demo">
                <h3>üèóÔ∏è Component Explorer</h3>
                <p>Hover over each component to learn more:</p>
                
                <div id="componentGrid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <div class="system-component" onmouseover="showComponentInfo('loadbalancer')" onclick="toggleComponent('loadbalancer')">
                        ‚öñÔ∏è Load Balancer
                    </div>
                    <div class="system-component" onmouseover="showComponentInfo('cache')" onclick="toggleComponent('cache')">
                        üèÉ‚Äç‚ôÇÔ∏è Cache
                    </div>
                    <div class="system-component" onmouseover="showComponentInfo('cdn')" onclick="toggleComponent('cdn')">
                        üåê CDN
                    </div>
                    <div class="system-component" onmouseover="showComponentInfo('queue')" onclick="toggleComponent('queue')">
                        üì¨ Message Queue
                    </div>
                    <div class="system-component" onmouseover="showComponentInfo('monitor')" onclick="toggleComponent('monitor')">
                        üìä Monitoring
                    </div>
                    <div class="system-component" onmouseover="showComponentInfo('auth')" onclick="toggleComponent('auth')">
                        üîê Authentication
                    </div>
                </div>
                
                <div id="componentInfo" class="info-box" style="margin-top: 20px; min-height: 80px;">
                    <strong>Hover over components to learn more!</strong>
                </div>
            </div>

            <div class="quiz">
                <h3>üéÆ Component Matching Game</h3>
                <p id="gameInstructions">Match the component with its primary purpose:</p>
                <div id="matchingGame">
                    <!-- Game will be populated by JavaScript -->
                </div>
                <div id="gameScore">Score: <span>0</span>/6</div>
            </div>
        </div>

        <!-- Lesson 4: Real-World Example -->
        <div class="lesson" data-lesson="4">
            <h2>üåü Design a Real System: Video Streaming Service</h2>
            <p>Let's apply everything we've learned to design a system like Netflix or YouTube!</p>

            <div class="challenge">
                <h3>üé¨ Your Mission: Design "StreamFlix"</h3>
                <p>Requirements:</p>
                <ul>
                    <li>10 million active users</li>
                    <li>Videos up to 4K quality</li>
                    <li>Global audience</li>
                    <li>Real-time recommendations</li>
                </ul>
            </div>

            <div class="interactive-demo">
                <h3>üõ†Ô∏è System Builder</h3>
                <p>Drag components to build your streaming service:</p>
                
                <div id="streamingSystem" style="min-height: 400px; border: 2px dashed #ccc; border-radius: 10px; position: relative; padding: 20px;">
                    <div style="text-align: center; color: #666; margin-top: 150px;" id="systemPlaceholder">
                        Drag components here to build your system
                    </div>
                </div>
                
                <div class="component-palette" style="display: flex; flex-wrap: wrap; justify-content: center; margin-top: 20px;">
                    <div class="draggable" draggable="true" data-component="users">üë• Users</div>
                    <div class="draggable" draggable="true" data-component="cdn">üåê CDN</div>
                    <div class="draggable" draggable="true" data-component="loadbalancer">‚öñÔ∏è Load Balancer</div>
                    <div class="draggable" draggable="true" data-component="webserver">üñ•Ô∏è Web Servers</div>
                    <div class="draggable" draggable="true" data-component="videostore">üìπ Video Storage</div>
                    <div class="draggable" draggable="true" data-component="database">üóÑÔ∏è Database</div>
                    <div class="draggable" draggable="true" data-component="analytics">üìä Analytics</div>
                    <div class="draggable" draggable="true" data-component="ml">ü§ñ ML Engine</div>
                </div>
                
                <button class="btn" onclick="validateDesign()">‚úÖ Validate Design</button>
                <button class="btn" onclick="clearSystem()">üóëÔ∏è Clear</button>
                
                <div id="designFeedback"></div>
            </div>
        </div>

        <!-- Lesson 5: Best Practices -->
        <div class="lesson" data-lesson="5">
            <h2>‚ú® Best Practices & Next Steps</h2>
            <p>Congratulations! You've learned the fundamentals of system design. Here are key principles to remember:</p>

            <div class="info-box">
                <h3>üéØ Golden Rules of System Design:</h3>
                <ul style="margin: 10px 0; padding-left: 20px;">
                    <li><strong>Start Simple:</strong> Begin with a basic design and iterate</li>
                    <li><strong>Know Your Scale:</strong> Design for your actual user base</li>
                    <li><strong>Plan for Failure:</strong> Systems will fail, design for resilience</li>
                    <li><strong>Monitor Everything:</strong> You can't fix what you can't see</li>
                    <li><strong>Security First:</strong> Build security in, don't bolt it on</li>
                </ul>
            </div>

            <div class="challenge">
                <h3>üöÄ Your Final Challenge</h3>
                <p>Design a system for your dream startup idea! Consider:</p>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin: 20px 0;">
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                        <strong>üìä Scale</strong><br>
                        How many users will you have?
                    </div>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                        <strong>üéØ Features</strong><br>
                        What core features do you need?
                    </div>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                        <strong>üìà Growth</strong><br>
                        How will you handle rapid scaling?
                    </div>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                        <strong>üõ°Ô∏è Reliability</strong><br>
                        What happens if something breaks?
                    </div>
                </div>
                <textarea id="finalDesign" placeholder="Describe your system design here..." style="width: 100%; height: 150px; padding: 15px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 14px;"></textarea>
                <br>
                <button class="btn" onclick="submitFinalDesign()">üìù Submit Your Design</button>
            </div>

            <div class="info-box">
                <h3>üéì What's Next?</h3>
                <p>Continue your system design journey with these resources:</p>
                <ul style="margin: 10px 0; padding-left: 20px;">
                    <li>Practice with system design interview questions</li>
                    <li>Study real-world system architectures</li>
                    <li>Build small projects applying these concepts</li>
                    <li>Learn about specific technologies (Redis, Kafka, etc.)</li>
                    <li>Join system design communities and forums</li>
                </ul>
            </div>
        </div>

        <div class="navigation">
            <button class="btn" id="prevBtn" onclick="previousLesson()" disabled>‚Üê Previous</button>
            <button class="btn" id="nextBtn" onclick="nextLesson()">Next ‚Üí</button>
            <button class="btn" onclick="resetTutorial()">üîÑ Restart Tutorial</button>
        </div>
    </div>

    <script>
        let currentLesson = 1;
        const totalLessons = 5;
        let gameScore = 0;
        let customers = 10;
        let servers = 2;
        let systemComponents = [];

        // Component information
        const componentInfo = {
            'loadbalancer': 'Distributes incoming requests across multiple servers, like a traffic director ensuring no single server gets overwhelmed.',
            'cache': 'Stores frequently accessed data in fast memory, like keeping your favorite books on your desk instead of the library.',
            'cdn': 'Delivers content from servers close to users worldwide, like having local warehouses for faster shipping.',
            'queue': 'Manages background tasks and communication between services, like a todo list for your system.',
            'monitor': 'Tracks system health and performance, like a dashboard in your car showing speed, fuel, and engine status.',
            'auth': 'Verifies user identity and permissions, like a security guard checking IDs at a building entrance.'
        };

        function updateProgress() {
            const progress = (currentLesson / totalLessons) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function showLesson(lessonNum) {
            document.querySelectorAll('.lesson').forEach(lesson => {
                lesson.classList.remove('active');
            });
            document.querySelector(`.lesson[data-lesson="${lessonNum}"]`).classList.add('active');
            
            currentLesson = lessonNum;
            updateProgress();
            updateNavigation();
        }

        function nextLesson() {
            if (currentLesson < totalLessons) {
                showLesson(currentLesson + 1);
            }
        }

        function previousLesson() {
            if (currentLesson > 1) {
                showLesson(currentLesson - 1);
            }
        }

        function updateNavigation() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            prevBtn.disabled = currentLesson === 1;
            nextBtn.disabled = currentLesson === totalLessons;
            
            if (currentLesson === totalLessons) {
                nextBtn.textContent = 'üéâ Complete!';
                nextBtn.disabled = false;
                nextBtn.onclick = function() {
                    alert('üéâ Congratulations! You\'ve completed the System Design Tutorial!\n\nYou now understand the fundamentals of:\n‚Ä¢ System components\n‚Ä¢ Scalability\n‚Ä¢ Real-world design patterns\n‚Ä¢ Best practices\n\nKeep practicing and building amazing systems!');
                };
            } else {
                nextBtn.textContent = 'Next ‚Üí';
                nextBtn.onclick = nextLesson;
            }
        }

        function resetTutorial() {
            showLesson(1);
            gameScore = 0;
            customers = 10;
            servers = 2;
            resetRestaurant();
            clearSystem();
        }

        // Lesson 1: Basic system interaction
        function activateComponent(element, type) {
            document.querySelectorAll('.system-component').forEach(comp => {
                comp.classList.remove('active');
            });
            element.classList.add('active');
            
            const explanations = {
                'user': 'The User initiates requests to your system. This could be clicking a button, submitting a form, or any interaction.',
                'server': 'The Web Server receives user requests, processes them, and sends responses back. It\'s the middleman between users and data.',
                'database': 'The Database stores and retrieves data permanently. It\'s like the system\'s long-term memory.'
            };
            
            document.getElementById('systemExplanation').innerHTML = `<strong>${type.toUpperCase()}:</strong> ${explanations[type]}`;
            
            // Show connection lines
            if (type === 'server') {
                document.getElementById('line1').classList.add('visible');
            }
            if (type === 'database') {
                document.getElementById('line1').classList.add('visible');
                document.getElementById('line2').classList.add('visible');
            }
        }

        function selectAnswer(element, isCorrect) {
            const options = element.parentElement.querySelectorAll('.quiz-option');
            options.forEach(option => {
                option.onclick = null;
                if (option === element) {
                    option.classList.add(isCorrect ? 'correct' : 'incorrect');
                } else {
                    option.style.opacity = '0.5';
                }
            });
            
            if (isCorrect) {
                element.innerHTML += ' ‚úÖ Correct!';
            } else {
                element.innerHTML += ' ‚ùå Try again!';
            }
        }

        // Lesson 2: Scalability simulation
        function addCustomers() {
            customers += 100;
            document.getElementById('customerCount').textContent = customers;
            updateRestaurantMetrics();
        }

        function scaleSystem() {
            servers += 1;
            document.getElementById('servers').textContent = servers;
            updateRestaurantMetrics();
            
            const feedback = document.getElementById('scalingFeedback');
            feedback.innerHTML = '<div class="feedback success">üéâ Great! You added more servers. Wait times improved and customers are happier!</div>';
        }

        function resetRestaurant() {
            customers = 10;
            servers = 2;
            document.getElementById('customerCount').textContent = customers;
            document.getElementById('servers').textContent = servers;
            updateRestaurantMetrics();
            document.getElementById('scalingFeedback').innerHTML = '';
        }

        function updateRestaurantMetrics() {
            const waitTime = Math.max(1, Math.round(customers / servers / 2));
            const satisfaction = customers / servers < 25 ? 'üòä' : customers / servers < 50 ? 'üòê' : 'üò¢';
            
            document.getElementById('waitTime').textContent = waitTime + ' min';
            document.getElementById('satisfaction').textContent = satisfaction;
        }

        // Lesson 2: Drag and drop for scaling solutions
        document.addEventListener('DOMContentLoaded', function() {
            const draggables = document.querySelectorAll('.draggable');
            const dropZones = document.querySelectorAll('.drop-zone');
            
            draggables.forEach(draggable => {
                draggable.addEventListener('dragstart', function(e) {
                    e.dataTransfer.setData('text/plain', this.dataset.solution);
                    e.dataTransfer.setData('text/html', this.outerHTML);
                });
            });
            
            dropZones.forEach(dropZone => {
                dropZone.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    this.classList.add('drag-over');
                });
                
                dropZone.addEventListener('dragleave', function(e) {
                    this.classList.remove('drag-over');
                });
                
                dropZone.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.classList.remove('drag-over');
                    
                    const solutionType = e.dataTransfer.getData('text/plain');
                    const category = this.dataset.category;
                    
                    if (solutionType === category || 
                        (category === 'frontend' && (solutionType === 'frontend' || solutionType === 'caching')) ||
                        (category === 'backend' && solutionType === 'backend') ||
                        (category === 'database' && solutionType === 'database')) {
                        
                        const draggedElement = document.createElement('div');
                        draggedElement.innerHTML = e.dataTransfer.getData('text/html');
                        this.appendChild(draggedElement.firstChild);
                        this.innerHTML = this.innerHTML.replace('<p>' + this.querySelector('p').textContent + '</p>', '');
                    }
                });
            });
        });

        // Lesson 3: Component explorer
        function showComponentInfo(componentType) {
            const info = componentInfo[componentType];
            document.getElementById('componentInfo').innerHTML = `<strong>${componentType.toUpperCase()}:</strong> ${info}`;
        }

        function toggleComponent(componentType) {
            const component = event.target;
            component.classList.toggle('active');
            
            if (component.classList.contains('active')) {
                component.innerHTML += ' ‚úÖ';
            } else {
                component.innerHTML = component.innerHTML.replace(' ‚úÖ', '');
            }
        }

        // Lesson 3: Matching game
        function initMatchingGame() {
            const gameContainer = document.getElementById('matchingGame');
            const components = [
                { name: 'Load Balancer', purpose: 'Distribute traffic across servers' },
                { name: 'Cache', purpose: 'Store frequently accessed data' },
                { name: 'CDN', purpose: 'Deliver content globally' },
                { name: 'Message Queue', purpose: 'Handle background tasks' },
                { name: 'Monitoring', purpose: 'Track system health' },
                { name: 'Authentication', purpose: 'Verify user identity' }
            ];
            
            // Shuffle purposes
            const shuffledPurposes = [...components.map(c => c.purpose)].sort(() => Math.random() - 0.5);
            
            gameContainer.innerHTML = '';
            components.forEach((comp, index) => {
                const gameRow = document.createElement('div');
                gameRow.style.display = 'flex';
                gameRow.style.alignItems = 'center';
                gameRow.style.margin = '10px 0';
                gameRow.style.gap = '20px';
                gameRow.style.flexWrap = 'wrap';
                
                gameRow.innerHTML = `
                    <div style="background: #667eea; color: white; padding: 10px 20px; border-radius: 8px; min-width: 150px;">
                        ${comp.name}
                    </div>
                    <select onchange="checkMatch(this, '${comp.purpose}')" style="padding: 8px; border-radius: 5px; border: 2px solid #ddd;">
                        <option value="">Select purpose...</option>
                        ${shuffledPurposes.map(purpose => `<option value="${purpose}">${purpose}</option>`).join('')}
                    </select>
                    <span class="match-feedback"></span>
                `;
                
                gameContainer.appendChild(gameRow);
            });
        }

        function checkMatch(selectElement, correctPurpose) {
            const feedback = selectElement.nextElementSibling;
            if (selectElement.value === correctPurpose) {
                feedback.innerHTML = '‚úÖ';
                feedback.style.color = '#4CAF50';
                selectElement.style.borderColor = '#4CAF50';
                selectElement.disabled = true;
                gameScore++;
                document.querySelector('#gameScore span').textContent = gameScore;
                
                if (gameScore === 6) {
                    setTimeout(() => {
                        alert('üéâ Perfect! You\'ve mastered system components!');
                    }, 500);
                }
            } else if (selectElement.value !== '') {
                feedback.innerHTML = '‚ùå';
                feedback.style.color = '#f44336';
                selectElement.style.borderColor = '#f44336';
            }
        }

        // Lesson 4: System builder
        let droppedComponents = [];

        function initSystemBuilder() {
            const systemArea = document.getElementById('streamingSystem');
            const palette = document.querySelector('.component-palette');
            
            // Make system area droppable
            systemArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.style.backgroundColor = '#f0f8ff';
            });
            
            systemArea.addEventListener('dragleave', function(e) {
                this.style.backgroundColor = 'transparent';
            });
            
            systemArea.addEventListener('drop', function(e) {
                e.preventDefault();
                this.style.backgroundColor = 'transparent';
                
                const componentType = e.dataTransfer.getData('text/plain');
                
                // Create component in system
                const component = document.createElement('div');
                component.className = 'system-component';
                component.style.position = 'absolute';
                component.style.left = (e.offsetX - 50) + 'px';
                component.style.top = (e.offsetY - 25) + 'px';
                component.innerHTML = e.dataTransfer.getData('text/html').match(/>([^<]+)</)[1];
                component.dataset.component = componentType;
                
                this.appendChild(component);
                droppedComponents.push(componentType);
                
                // Hide placeholder
                document.getElementById('systemPlaceholder').style.display = 'none';
            });
            
            // Make palette items draggable
            palette.querySelectorAll('.draggable').forEach(item => {
                item.addEventListener('dragstart', function(e) {
                    e.dataTransfer.setData('text/plain', this.dataset.component);
                    e.dataTransfer.setData('text/html', this.outerHTML);
                });
            });
        }

        function validateDesign() {
            const feedback = document.getElementById('designFeedback');
            const requiredComponents = ['users', 'cdn', 'loadbalancer', 'webserver', 'videostore', 'database'];
            const optionalComponents = ['analytics', 'ml'];
            
            const hasRequired = requiredComponents.every(comp => droppedComponents.includes(comp));
            const hasOptional = optionalComponents.some(comp => droppedComponents.includes(comp));
            
            let feedbackHTML = '';
            
            if (hasRequired) {
                feedbackHTML += '<div class="feedback success">‚úÖ Excellent! You have all the essential components for a streaming service!</div>';
                
                if (hasOptional) {
                    feedbackHTML += '<div class="feedback success">üåü Bonus: You included advanced features like analytics and ML!</div>';
                }
                
                feedbackHTML += `
                    <div class="info-box" style="margin-top: 15px;">
                        <strong>Your StreamFlix Architecture:</strong><br>
                        ‚Ä¢ Users connect through CDN for fast video delivery<br>
                        ‚Ä¢ Load balancer distributes requests across web servers<br>
                        ‚Ä¢ Video storage handles massive video files<br>
                        ‚Ä¢ Database stores user data and metadata<br>
                        ${hasOptional ? '‚Ä¢ Analytics and ML provide insights and recommendations' : ''}
                    </div>
                `;
            } else {
                const missing = requiredComponents.filter(comp => !droppedComponents.includes(comp));
                feedbackHTML = `<div class="feedback error">‚ùå Your design is missing: ${missing.join(', ')}. Try adding these essential components!</div>`;
            }
            
            feedback.innerHTML = feedbackHTML;
        }

        function clearSystem() {
            const systemArea = document.getElementById('streamingSystem');
            systemArea.innerHTML = '<div style="text-align: center; color: #666; margin-top: 150px;" id="systemPlaceholder">Drag components here to build your system</div>';
            droppedComponents = [];
            document.getElementById('designFeedback').innerHTML = '';
        }

        // Lesson 5: Final design submission
        function submitFinalDesign() {
            const design = document.getElementById('finalDesign').value;
            if (design.trim().length < 50) {
                alert('Please provide a more detailed design description (at least 50 characters).');
                return;
            }
            
            const feedback = `
                <div class="feedback success" style="margin-top: 15px;">
                    üéâ Amazing work! You've successfully completed the System Design Tutorial!
                    <br><br>
                    <strong>Your design shows understanding of:</strong><br>
                    ‚Ä¢ System components and their roles<br>
                    ‚Ä¢ Scalability considerations<br>
                    ‚Ä¢ Real-world application<br>
                    ‚Ä¢ Best practices<br>
                    <br>
                    Keep practicing and you'll become a system design expert! üöÄ
                </div>
            `;
            
            document.getElementById('finalDesign').insertAdjacentHTML('afterend', feedback);
            document.getElementById('finalDesign').disabled = true;
        }

        // Initialize components when lessons are shown
        document.addEventListener('DOMContentLoaded', function() {
            updateProgress();
            updateNavigation();
            updateRestaurantMetrics();
            
            // Initialize matching game when lesson 3 is shown
            const observer = new MutationObserver(function(mutations) {
                mutations.forEach(function(mutation) {
                    if (mutation.target.classList.contains('lesson') && 
                        mutation.target.classList.contains('active') &&
                        mutation.target.dataset.lesson === '3') {
                        setTimeout(initMatchingGame, 100);
                    }
                    if (mutation.target.classList.contains('lesson') && 
                        mutation.target.classList.contains('active') &&
                        mutation.target.dataset.lesson === '4') {
                        setTimeout(initSystemBuilder, 100);
                    }
                });
            });
            
            document.querySelectorAll('.lesson').forEach(lesson => {
                observer.observe(lesson, { attributes: true, attributeFilter: ['class'] });
            });
        });
    </script>
</body>
</html>
            